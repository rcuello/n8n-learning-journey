# Instalaci√≥n de n8n en Render con Supabase

## Introducci√≥n

Esta gu√≠a te mostrar√° c√≥mo desplegar n8n de forma gratuita usando Render como plataforma de hosting y Supabase como base de datos PostgreSQL. Esta combinaci√≥n es ideal para comenzar con n8n sin costos iniciales.

## Ventajas de esta configuraci√≥n

- ‚úÖ **Gratuito**: Ambos servicios ofrecen planes gratuitos generosos
- ‚úÖ **Sin c√≥digo**: Usa la imagen oficial de Docker de n8n
- ‚úÖ **Actualizaciones autom√°ticas**: Siempre tendr√°s la √∫ltima versi√≥n estable
- ‚úÖ **Escalable**: F√°cil upgrade cuando necesites m√°s recursos
- ‚úÖ **Confiable**: Infraestructura profesional y respaldos autom√°ticos
- ‚úÖ **Configuraci√≥n simple**: Sin necesidad de repositorios o builds

## Requisitos previos

- Cuenta de email v√°lida
- Navegador web actualizado
- Conocimientos b√°sicos de configuraci√≥n web (opcional)

## Paso 1: Configurar Supabase (Base de datos)

### 1.1 Crear cuenta en Supabase

1. Ve a [supabase.com](https://supabase.com)
2. Haz clic en "Start your project"
3. Reg√≠strate con tu cuenta de GitHub (recomendado)
4. Acepta los t√©rminos y condiciones

### 1.2 Crear una organizaci√≥n personal

1. Despu√©s del registro, ser√°s dirigido al dashboard principal
2. Si es tu primera vez, Supabase te pedir√° crear una organizaci√≥n:
   - **Organization name**: Tu nombre o nombre de tu empresa (ej: "Mi Empresa Automations")
   - **Organization type**: Selecciona **"Personal"** 
   - **Plan**: Autom√°ticamente se asignar√° el **"Free Plan"**
   - Haz clic en "Create organization"

   ![alt text](./assets/supabase-create-org.png)

> üí° **Nota**: La organizaci√≥n es como una carpeta que contendr√° todos tus proyectos. Puedes crear m√∫ltiples proyectos dentro de una organizaci√≥n.


### 1.3 Crear un nuevo proyecto

1. Una vez creada la organizaci√≥n, haz clic en "New project"
2. Selecciona tu organizaci√≥n reci√©n creada
3. Configura el proyecto:
   - **Name**: `n8n-database` (o-el-nombre-que-prefieras)
   - **Database Password**: Genera una contrase√±a segura y **gu√°rdala en un lugar seguro**
   - **Region**: `East US (Ohio)`

4. Haz clic en "Create new project"
5. Espera 2-3 minutos mientras se aprovisiona la infraestructura

![alt text](./assets/supabase-create-new-project.png)

### 1.4 Verificar la creaci√≥n del proyecto

Una vez completado, ver√°s:

- ‚úÖ **Database**: Estado "Healthy" 
- ‚úÖ **API**: URLs generadas autom√°ticamente
- ‚úÖ **Authentication**: Configurado y listo
- üìä **Dashboard**: Con m√©tricas b√°sicas disponibles

![alt text](assets/supabase-project-status.png)

### 1.5 Obtener la cadena de conexi√≥n

1. Una vez creado el proyecto, ve a **Connect**
![alt text](assets/supabase-connect.png)

2. En la secci√≥n **"Transaction pooler"**, haz clic en **"View parameters"** para expandir las opciones
3. Ver√°s los par√°metros de conexi√≥n individuales:
   - **Host**: `aws-0-[region].pooler.supabase.com`
   - **Database**: `postgres` 
   - **Port**: `6543` (puerto-del-pooler, no-el-est√°ndar-5432)
   - **User**: `postgres.[project-ref]`
   - **Password**: `[la-contrase√±a-que-creaste]`
![alt text](assets/supabase-connection-string.png)

## Paso 2: Configurar Render (Hosting)

### 2.1 Crear cuenta en Render

1. Ve a [render.com](https://render.com)
2. Haz clic en ["Get started"](https://dashboard.render.com/register)
3. Reg√≠strate con tu email o cuenta de GitHub
4. Verifica tu email si es necesario

![alt text](assets/render-create-account.png)

### 2.2 Crear el servicio web en Render

1. En el dashboard de Render, haz clic en "New +"
2. Selecciona "Web Service"

![alt text](assets/render-new-web-service.png)

3. En la secci√≥n "You are deploying a Web Service", selecciona **"Existing image"**
4. En el campo de imagen Docker, ingresa: `docker.n8n.io/n8nio/n8n`

![alt text](assets/render-existing-image.png)

5. Configura el servicio:
   - **Name**: `n8n-app` (o-tu-nombre-preferido)
   - **Project**: Haz clic en "Create new project" si quieres organizar mejor tus servicios
      - **Project name**: `n8n-automation-suite` (o-el-nombre-que prefieras)
      - **Environment name**: `Production`

      ![alt text](assets/render-create-project.png)

   - **Region**: `Oregon (US West)`
   - **Instance Type**: `Free 512 MB (RAM)`
   
     ![alt text](assets/render-instance-type.png)


> üí° **Nota**: Al usar la imagen oficial de Docker, no necesitas configurar repositorio ni comandos de build. Render descargar√° y ejecutar√° directamente la imagen oficial de n8n.

## Paso 3: Configurar Variables de Entorno

![alt text](assets/render-env-variables.png)

En la secci√≥n "Environment" de tu servicio en Render, agrega las siguientes variables:

### 3.1 Variables de base de datos (Supabase)

| Variable | Valor | Descripci√≥n |
|----------|-------|-------------|
| `DB_TYPE` | `postgresdb` | Tipo de base de datos |
| `DB_POSTGRESDB_DATABASE` | `postgres` | Nombre de la base de datos |
| `DB_POSTGRESDB_HOST` | `db.[PROJECT-REF].supabase.co` | Host de Supabase (obtener de Supabase) |
| `DB_POSTGRESDB_USER` | `postgres` | Usuario de PostgreSQL (obtener de Supabase) |
| `DB_POSTGRESDB_PASSWORD` | `[TU-PASSWORD]` | Contrase√±a de Supabase |
| `DB_POSTGRESDB_PORT` | `5432` | Puerto PostgreSQL (obtener de Supabase) |
| `DB_POSTGRESDB_SCHEMA` | `public` | Schema de la base de datos |
| `DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED` | `FALSE` | Desactivar validaci√≥n SSL estricta |

### 3.2 Variables de configuraci√≥n de n8n

| Variable | Valor | Descripci√≥n |
|----------|-------|-------------|
| `N8N_HOST` | `tu-app-name.onrender.com` | Dominio de tu aplicaci√≥n (sin https://) |
| `N8N_PORT` | `443` | Puerto HTTPS para Render |
| `N8N_PROTOCOL` | `https` | Protocolo de conexi√≥n |
| `WEBHOOK_URL` | `https://tu-app-name.onrender.com` | URL completa de webhooks |

### 3.3 Variables de seguridad y encriptaci√≥n

| Variable | Valor | Descripci√≥n |
|----------|-------|-------------|
| `N8N_ENCRYPTION_KEY` | `42072e543214e3ffa40474006d3dbbaa` | Clave de encriptaci√≥n principal |
| `NON_ENCRYPTION_KEY` | `683ECC56E7BEFA1E5AF5D85C5E43E` | Clave adicional de seguridad |
| `N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS` | `TRUE` | Forzar permisos de archivos |

### 3.4 Variables de configuraci√≥n regional y funcional

| Variable | Valor | Descripci√≥n |
|----------|-------|-------------|
| `GENERIC_TIMEZONE` | `America/Bogota` | Zona horaria principal |
| `TZ` | `America/Bogota` | Zona horaria del sistema |
| `N8N_RUNNERS_ENABLED` | `TRUE` | Habilitar runners para mejor rendimiento |

### 3.5 C√≥mo obtener valores de Supabase

Para obtener los valores correctos de tu base de datos Supabase:

1. Ve a tu proyecto en Supabase
2. Navega a **Settings** > **Database**
3. En la secci√≥n "Connection string", encontrar√°s:
   - **Host**: `db.[PROJECT-REF].supabase.co`
   - **User**: `postgres` 
   - **Port**: `5432`
   - **Database**: `postgres`
   - **Password**: La que configuraste al crear el proyecto

4. Copia estos valores exactos a las variables correspondientes

### 3.6 Generar claves de encriptaci√≥n personalizadas (Opcional)

Si prefieres generar tus propias claves de encriptaci√≥n:

```bash
# Para N8N_ENCRYPTION_KEY (32 bytes)
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# Para NON_ENCRYPTION_KEY (16 bytes)  
node -e "console.log(require('crypto').randomBytes(16).toString('hex').toUpperCase())"
```
![alt text](assets/render-enc-key.png)

![alt text](assets/render-n8n-enc-key.png)

> ‚ö†Ô∏è **Importante**: Si cambias las claves de encriptaci√≥n despu√©s de tener workflows guardados, estos podr√≠an volverse ilegibles. Guarda las claves en un lugar seguro.

## Paso 4: Desplegar la aplicaci√≥n

1. Despu√©s de configurar todas las variables, haz clic en "Create Web Service"
2. Render comenzar√° a construir y desplegar tu aplicaci√≥n
3. El proceso puede tomar 5-10 minutos la primera vez
4. Una vez completado, obtendr√°s una URL como: `https://tu-app.onrender.com`

## Paso 5: Configuraci√≥n inicial de n8n

1. Accede a tu URL de Render
2. Si configuraste autenticaci√≥n b√°sica, ingresa tus credenciales
3. Completa la configuraci√≥n inicial:
   - Crea tu cuenta de administrador
   - Configura las preferencias b√°sicas
   - Verifica la conexi√≥n a la base de datos

## Paso 6: Configuraci√≥n adicional

### 6.1 Webhooks y dominios personalizados

1. Actualiza la variable `WEBHOOK_URL` con tu dominio final
2. Si usas un dominio personalizado, config√∫ralo en Render:
   - Ve a Settings > Custom Domains
   - Agrega tu dominio y configura los DNS

### 6.2 Mantener activo el servicio (Plan gratuito)

El plan gratuito de Render "duerme" despu√©s de 15 minutos de inactividad:

- **Opci√≥n 1**: Configurar un webhook que haga ping cada 10 minutos
- **Opci√≥n 2**: Usar un servicio como UptimeRobot
- **Opci√≥n 3**: Actualizar a plan pagado ($7/mes)

## Soluci√≥n de problemas

### Error de conexi√≥n a la base de datos

1. Verifica que la URL de conexi√≥n est√© correcta
2. Confirma que la contrase√±a no tenga caracteres especiales problem√°ticos
3. Revisa que todas las variables de entorno est√©n configuradas

### Error "Service Unavailable" o puerto incorrecto

1. Verifica que `N8N_PORT` est√© configurado como `5678`
2. Revisa que Render est√© escuchando en el puerto correcto
3. Espera unos minutos para que el contenedor se inicie completamente

### Autenticaci√≥n no funciona

1. Verifica que `N8N_BASIC_AUTH_ACTIVE` est√© en `true`
2. Confirma que usuario y contrase√±a sean correctos
3. Prueba desactivar la autenticaci√≥n temporalmente

## Limitaciones del plan gratuito

### Render (Plan gratuito)
- 750 horas/mes de tiempo de ejecuci√≥n
- Duerme despu√©s de 15 min de inactividad
- 512 MB RAM
- 1 CPU compartida

### Supabase (Plan gratuito)
- 500 MB de almacenamiento
- 2 proyectos activos m√°ximo
- 50,000 autenticaciones/mes

## Recursos adicionales

- [Documentaci√≥n oficial de n8n](https://docs.n8n.io/)
- [Render Documentation](https://render.com/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [n8n Community](https://community.n8n.io/)

---

> üí° **Tip**: Guarda todas las credenciales y URLs en un gestor de contrase√±as seguro. Necesitar√°s acceso a ellas para futuras configuraciones y mantenimiento.

---

‚úçÔ∏è Autor: **Profesor Ronald Cuello**  
üìç Colombia ‚Äì 2025