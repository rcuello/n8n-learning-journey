# InstalaciÃ³n de n8n con NPM y exposiciÃ³n por Ngrok

## IntroducciÃ³n

En esta guÃ­a aprenderÃ¡s a instalar **n8n** de forma local usando **Node.js y NPM**.
Esta opciÃ³n es ideal para comenzar rÃ¡pidamente, probar flujos en tu mÃ¡quina personal y experimentar sin necesidad de configurar servidores en la nube.

Adicionalmente, aprenderÃ¡s cÃ³mo **exponer tu instancia local de n8n a Internet usando Ngrok**, lo que permite probar webhooks y conexiones HTTPS de forma sencilla.

---

## Ventajas de esta configuraciÃ³n

* âœ… **RÃ¡pido y directo**: InstalaciÃ³n local sin necesidad de contenedores.
* âœ… **Entorno de desarrollo ideal**: Perfecto para aprender y hacer pruebas.
* âœ… **Compatible**: Funciona en Windows, macOS y Linux.
* âœ… **Ngrok**: Permite exponer tu instancia a Internet con HTTPS para probar integraciones externas.
* âš ï¸ **LimitaciÃ³n**: No es recomendado para entornos de producciÃ³n.

---

## Requisitos previos

* [Node.js](https://nodejs.org) versiÃ³n **18 o superior**
* [npm](https://www.npmjs.com/) (incluido con Node.js)
* Una terminal (PowerShell, Git Bash o similar en Windows)
* [Ngrok](https://ngrok.com/) (para exponer localhost a Internet)

---

## Paso 1: Instalar n8n con NPM

### 1.1 Verificar Node.js y NPM

```bash
node -v
npm -v
```

DeberÃ­as ver versiones instaladas (ejemplo: `v20.x` para Node y `10.x` para npm).

### 1.2 Instalar n8n globalmente

```bash
npm install n8n -g
```

### 1.3 Verificar instalaciÃ³n

```bash
n8n --version
```

DeberÃ­as obtener el nÃºmero de versiÃ³n de n8n.

---

## Paso 2: Ejecutar n8n

En la terminal:

```bash
n8n
# o
n8n start
```

Esto iniciarÃ¡ el servidor local de n8n en:

```
http://localhost:5678
```

Abre el navegador y accede a esa direcciÃ³n para usar la interfaz de n8n.

---

## Paso 3: Crear y configurar una cuenta en Ngrok

Antes de exponer n8n en Internet, es necesario contar con una **cuenta en Ngrok** y configurar un **authtoken** en tu mÃ¡quina.

### 3.1 Registro en Ngrok

1. Ingresa a [https://ngrok.com](https://ngrok.com)
2. Haz clic en [**Sign up**](https://dashboard.ngrok.com/signup)
3. RegÃ­strate usando tu correo electrÃ³nico, cuenta de Google o GitHub

![ngrok Signup](./assets/n8n-npm-ngrok-signup.png)

### 3.2 Aceptar tÃ©rminos y condiciones
1. Durante el registro, Ngrok te pedirÃ¡ aceptar los **TÃ©rminos de Servicio** y la **PolÃ­tica de Privacidad**.
2. Marca la casilla correspondiente antes de continuar.

![alt text](./assets/n8n-npm-ngrok-terminos-condiciones.png) 

## 3.3 ConfiguraciÃ³n de MFA (Opcional pero recomendado)

1. Tras el registro, tendrÃ¡s la opciÃ³n de configurar **Multi-Factor Authentication (MFA)**.
2. Ngrok soporta aplicaciones como Google Authenticator, Authy o Microsoft Authenticator.
3. Si decides configurarlo:

  1. Escanea el QR en tu app de autenticaciÃ³n.
  2. Ingresa el cÃ³digo de verificaciÃ³n generado.
4. Si no deseas activarlo, puedes saltar este paso y configurarlo mÃ¡s adelante desde el perfil.

## 3.4 Onboarding en Ngrok

1. DespuÃ©s de la verificaciÃ³n, Ngrok te redirige a un breve **formulario de onboarding** donde debes indicar:
* **CÃ³mo te describes:** (ej. *Software Architect*, *Developer*, *Student*).
* **QuÃ© te interesa usar de Ngrok:**

Ejemplo de pantalla del formulario de onboarding:

![alt text](./assets/n8n-npm-ngrok-onboarding.png)

## 3.5 Dashboard en Ngrok
1. Una vez dentro, accederÃ¡s al [Dashboard de Ngrok](https://dashboard.ngrok.com/get-started/setup/windows)

![alt text](./assets/n8n-npm-ngrok-dashboard.png)

---

### 3.6 Obtener el authtoken

1. En el **Dashboard**, ve a la secciÃ³n **Your Authtoken**
2. Copia el valor que aparece en pantalla (ejemplo: `2LRf9aC123ABCxYpQr...`)

---

### 3.7 Instalar Ngrok (si no lo has hecho)

* Descarga desde [ngrok.com/download](https://ngrok.com/download)
* Extrae y mueve el binario a una carpeta incluida en tu **PATH**
* Verifica instalaciÃ³n:

```bash
ngrok version
```

---

### 3.8 Configurar authtoken en tu mÃ¡quina

En la terminal:

```bash
ngrok config add-authtoken TU_AUTHTOKEN_AQUI
```

Esto guardarÃ¡ el token en el archivo de configuraciÃ³n de Ngrok, normalmente ubicado en:

* **Linux/MacOS** â†’ `~/.ngrok2/ngrok.yml`
* **Windows** â†’ `C:\Users\TU_USUARIO\.ngrok2\ngrok.yml`

---

âœ… Ahora tu instalaciÃ³n de Ngrok estÃ¡ lista para usarse.
En el siguiente paso expondremos el puerto **5678** de n8n al mundo con HTTPS.

---

## Paso 4: Exponer localhost con Ngrok

Muchas integraciones en n8n (ej. **webhooks**) requieren una URL accesible pÃºblicamente con HTTPS. Para esto, usaremos **Ngrok**.

### 4.1 Exponer el puerto de n8n (5678)

Ejecuta:

```bash
ngrok http 5678
```

VerÃ¡s una salida similar a:

```
Forwarding    https://ab12-34-56-78.ngrok-free.app -> http://localhost:5678
```

ðŸ‘‰ Usa la URL HTTPS generada (`https://...ngrok-free.app`) en tus integraciones externas.

---

## Paso 5: ConfiguraciÃ³n de n8n para usar Ngrok

En lugar de usar la URL `localhost`, configura n8n para reconocer la URL pÃºblica de Ngrok:

### 5.1 Definir variable de entorno

Ejecuta n8n con:

```bash
N8N_HOST=ab12-34-56-78.ngrok-free.app \
N8N_PORT=5678 \
N8N_PROTOCOL=https \
WEBHOOK_URL=https://ab12-34-56-78.ngrok-free.app \
n8n
```

### 5.2 Confirmar

* Abre la URL de Ngrok en el navegador para acceder a n8n.
* Los **webhooks** generados por n8n ahora usarÃ¡n la URL pÃºblica de Ngrok.

---

## Paso 6: Uso tÃ­pico en desarrollo

* ðŸš€ Ejecutar `n8n` en una terminal
* ðŸš€ En otra terminal, ejecutar `ngrok http 5678`
* ðŸ‘‰ Copiar la URL pÃºblica de Ngrok en tus integraciones externas

> ðŸ’¡ **Tip**: Cada vez que reinicies Ngrok, la URL cambiarÃ¡ (a menos que tengas plan de pago).

---

## SoluciÃ³n de problemas

* **n8n no arranca** â†’ Verifica que tienes Node.js 18+
* **Ngrok no expone la URL** â†’ AsegÃºrate de que n8n estÃ¡ corriendo en el puerto 5678
* **Webhook no responde** â†’ Confirma que configuraste `WEBHOOK_URL` correctamente

---

## Recursos adicionales

* [DocumentaciÃ³n oficial de n8n](https://docs.n8n.io/)
* [Ngrok Documentation](https://ngrok.com/docs)
* [Comunidad n8n](https://community.n8n.io/)

---
